---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import ObservationsList from '../components/ObservationsList.svelte';

const stats = [
  { icon: 'KB', value: '~5 KB', label: 'Avg Request Size' },
  { icon: '<1s', value: '< 1 second', label: 'Typical Load Time' },
  { icon: 'G', value: 'GeoJSON', label: 'Compact Format' },
];
---

<Layout title="API Demo | GLOBE Lite">
  <Header />

  <main>
    <!-- Hero -->
    <section class="py-20 px-4">
      <div class="max-w-4xl mx-auto text-center">
        <span class="inline-block px-3 py-1 text-xs font-medium bg-[color:var(--accent-dim)] text-nasa-cyan rounded-full mb-6">
          API Integration
        </span>
        <h1 class="text-4xl font-bold text-globe-text mb-4">
          Low-Bandwidth <span class="text-nasa-cyan">Data Fetching</span>
        </h1>
        <p class="text-lg text-globe-muted max-w-2xl mx-auto">
          Testing optimized data retrieval from the <strong class="text-globe-text">GLOBE Observer API</strong>
        </p>
      </div>
    </section>

    <!-- Content -->
    <div class="max-w-4xl mx-auto px-4 space-y-8 pb-16">
      <!-- API Endpoint Info -->
      <div class="glass-panel p-6">
        <h3 class="text-lg font-semibold text-globe-text mb-4">API Endpoint</h3>
        <div class="glass-card p-4 font-mono text-sm overflow-x-auto">
          <span class="text-nasa-cyan">GET</span>
          <span class="text-globe-muted ml-2">https://api.globe.gov/search/v1/measurement/protocol/measureddate/</span>
        </div>
        <p class="text-sm text-globe-muted mt-4">
          Using <code class="text-nasa-cyan">mosquito_habitat_mapper</code> protocol with sample mode for faster loading.
        </p>
      </div>

      <!-- Observations List -->
      <div class="glass-panel p-6">
        <h3 class="text-lg font-semibold text-globe-text mb-4">Recent Mosquito Habitat Observations</h3>
        <p class="text-globe-muted mb-6">Live data from GLOBE API</p>
        <div class="border-t border-[color:var(--border)] pt-6">
          <ObservationsList client:load protocol="mosquito_habitat_mapper" limit={10} />
        </div>
      </div>

      <!-- Bandwidth Stats -->
      <div class="grid sm:grid-cols-3 gap-6">
        {stats.map((stat) => (
          <div class="glass-card p-6 text-center">
            <div class="step-number w-12 h-12 mx-auto mb-3 text-xs flex items-center justify-center">{stat.icon}</div>
            <div class="text-xl font-bold text-globe-text">{stat.value}</div>
            <div class="text-sm text-globe-muted">{stat.label}</div>
          </div>
        ))}
      </div>

      <!-- Back -->
      <div class="text-center py-8">
        <a href="/" class="secondary-btn">Back to Home</a>
      </div>
    </div>
  </main>

  <Footer />
</Layout>
